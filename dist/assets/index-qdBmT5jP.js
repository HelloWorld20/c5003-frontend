import{_ as R,N as B}from"./round-add-DLFSrtba.js";import{_ as F,a as A}from"./round-search-tzxKjPJ8.js";import{d as G,r as g,bv as V,a as j,F as H,ab as J,b as K,f as t,w as o,g as n,c7 as c,B as d,h as y,b_ as Y,e as x,c3 as L,i as h,be as q,o as O}from"./index-Fa26LLGJ.js";import{f as Q,d as W}from"./employee-B_1zAmv9.js";import{_ as X,a as u}from"./Grid-B2FtaVgP.js";import{_ as z}from"./DatePicker-rMn-1Kn0.js";import{_ as Z,a as ee}from"./DataTable-rjo85Lnz.js";import{_ as ae}from"./FormItem-BZKeQ143.js";import{N as w}from"./Input-CaFfWc_O.js";import{_ as v}from"./InputNumber-CPlT6_RR.js";import{N as le}from"./Select-Bmi32fUm.js";import{_ as N}from"./Space-DmpO1c5Z.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-OLpDKtti.js";import"./get-D-rsvxxO.js";import"./Follower-YbKMuAEO.js";import"./use-locale-3ZZNx-H2.js";import"./use-compitable-BSzTa9o4.js";import"./get-slot-Bk_rJcZu.js";import"./use-keyboard-DyVeZvMZ.js";import"./FocusDetector-UVToc5yR.js";import"./Forward-Cjyugl_j.js";import"./Dropdown-CxFzKVN2.js";import"./create-C8zW23Rr.js";import"./Tooltip-DtJC1sbC.js";import"./download-C2161hUv.js";const ne={class:"user-management"},oe={class:"flex items-center gap-4 mt-4"},ie={class:"flex items-center gap-2"},re=G({__name:"index",setup(ue){const D=q(),e=g({emp_no_min:null,emp_no_max:null,birth_date_range:null,hire_date_range:null,name:"",gender:"",salary_min:null,salary_max:null,dept_name:"",title:""}),f=g([]),r=V({page:1,pageSize:10,"item-count":0}),b=g(!1),p=g(1),M=j(()=>{const l=r["item-count"];return l===0?1:Math.ceil(l/r.pageSize)}),$=[{title:"Employee ID",key:"emp_no",width:100},{title:"Employee Name",key:"name",width:180,render:l=>`${l.first_name} ${l.last_name}`},{title:"Birth Date",key:"birth_date",width:140},{title:"Dept Name",key:"dept_name",width:180},{title:"Title",key:"title",width:180},{title:"Salary",key:"salary",width:100,render:l=>`$ ${l.salary}`},{title:"Hire Date",key:"hire_date",width:140},{title:"Gender",key:"gender",width:120,render:l=>l.gender==="M"?"male":"female"},{title:"Operation",key:"actions",width:150,fixed:"right",render:l=>h(N,{},{default:()=>[h(d,{size:"small",type:"primary",onClick:()=>I(l)},{default:()=>"Edit"}),h(B,{onPositiveClick:()=>E(l)},{trigger:()=>h(d,{size:"small",type:"error"},{default:()=>"Delete"}),default:()=>"Are you sure to delete this employee?"})]})}];function I(l){D.push({path:"employees/detail",query:{emp_no:l.emp_no}})}async function E(l){try{await W(l.emp_no),_(),window.$message?.success("delete success")}catch(a){window.$message?.error(a||"fail to delete")}}function P(){console.log("搜索条件:",e),r.page=1,_()}function S(){C(),_()}function U(){console.log("新增用户"),D.push("/employees/detail")}function k(){const l=p.value;if(!l||l<1){window.$message?.warning("Please enter a valid page number"),p.value=r.page;return}const a=M.value;if(l>a){window.$message?.warning(`Page number cannot exceed ${a}`),p.value=r.page;return}r.page=l}function C(){e.value={emp_no_min:null,emp_no_max:null,birth_date_range:null,hire_date_range:null,name:"",gender:"",salary_min:null,salary_max:null,dept_name:"",title:""}}async function _(){b.value=!0;try{const l={page:r.page||1,pageSize:r.pageSize||10};if(e.value.emp_no_min!==null&&e.value.emp_no_min!==""&&(l.emp_no_min=parseInt(e.value.emp_no_min)),e.value.emp_no_max!==null&&e.value.emp_no_max!==""&&(l.emp_no_max=parseInt(e.value.emp_no_max)),e.value.birth_date_range){const[s,m]=e.value.birth_date_range;s&&(l.birth_date_min=c(s).format("YYYY-MM-DD")),m&&(l.birth_date_max=c(m).format("YYYY-MM-DD"))}if(e.value.hire_date_range){const[s,m]=e.value.hire_date_range;s&&(l.hire_date_min=c(s).format("YYYY-MM-DD")),m&&(l.hire_date_max=c(m).format("YYYY-MM-DD"))}e.value.salary_min!==null&&e.value.salary_min!==""&&(l.salary_min=parseInt(e.value.salary_min)),e.value.salary_max!==null&&e.value.salary_max!==""&&(l.salary_max=parseInt(e.value.salary_max)),e.value.name&&(l.name=e.value.name),e.value.gender&&(l.gender=e.value.gender),e.value.dept_name&&(l.dept_name=e.value.dept_name),e.value.title&&(l.title=e.value.title);const a=await Q(l);if(a&&a.data){if(f.value=a.data,a.total!==void 0)r["item-count"]=a.total;else if(Array.isArray(a.data))if(a.data.length<r.pageSize)r["item-count"]=(r.page-1)*r.pageSize+a.data.length;else{const s=Math.max(100,r.page*r.pageSize+1);r["item-count"]=s}}else f.value=[],r["item-count"]=0,(e.value.name||e.value.emp_no_min||e.value.emp_no_max||e.value.birth_date_range||e.value.hire_date_range||e.value.gender||e.value.salary_min||e.value.salary_max||e.value.dept_name||e.value.title)&&window.$message?.warning("No data found")}catch(l){console.error("Search error:",l),window.$message?.error(l?.message||"Failed to fetch employees"),f.value=[]}finally{b.value=!1}}return H(()=>{S(),_()}),J(()=>r.page,l=>{p.value=l,_()}),(l,a)=>{const s=F,m=A,T=R;return O(),K("div",ne,[t(n(Y),{title:"Search Conditions",class:"mb-4"},{default:o(()=>[t(n(ae),{model:e.value,"label-placement":"left","label-width":"130px",class:"search-form"},{default:o(()=>[t(n(X),{cols:4,"x-gap":16,"y-gap":16},{default:o(()=>[t(n(u),{label:"Employee Name",span:1},{default:o(()=>[t(n(w),{value:e.value.name,"onUpdate:value":a[0]||(a[0]=i=>e.value.name=i),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),t(n(u),{label:"Employee ID Min",span:1},{default:o(()=>[t(n(v),{value:e.value.emp_no_min,"onUpdate:value":a[1]||(a[1]=i=>e.value.emp_no_min=i),clearable:"",placeholder:"Min","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Employee ID Max",span:1},{default:o(()=>[t(n(v),{value:e.value.emp_no_max,"onUpdate:value":a[2]||(a[2]=i=>e.value.emp_no_max=i),clearable:"",placeholder:"Max","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Gender",span:1},{default:o(()=>[t(n(le),{value:e.value.gender,"onUpdate:value":a[3]||(a[3]=i=>e.value.gender=i),clearable:"",placeholder:"Please Select",options:[{label:"Male",value:"M"},{label:"Female",value:"F"}]},null,8,["value"])]),_:1}),t(n(u),{label:"Birth Date Range",span:1},{default:o(()=>[t(n(z),{value:e.value.birth_date_range,"onUpdate:value":a[4]||(a[4]=i=>e.value.birth_date_range=i),type:"daterange",clearable:"",placeholder:"Select Date Range",style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Hire Date Range",span:1},{default:o(()=>[t(n(z),{value:e.value.hire_date_range,"onUpdate:value":a[5]||(a[5]=i=>e.value.hire_date_range=i),type:"daterange",clearable:"",placeholder:"Select Date Range",style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Salary Min",span:1},{default:o(()=>[t(n(v),{value:e.value.salary_min,"onUpdate:value":a[6]||(a[6]=i=>e.value.salary_min=i),clearable:"",placeholder:"Min","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Salary Max",span:1},{default:o(()=>[t(n(v),{value:e.value.salary_max,"onUpdate:value":a[7]||(a[7]=i=>e.value.salary_max=i),clearable:"",placeholder:"Max","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),t(n(u),{label:"Dept Name",span:1},{default:o(()=>[t(n(w),{value:e.value.dept_name,"onUpdate:value":a[8]||(a[8]=i=>e.value.dept_name=i),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),t(n(u),{label:"Title",span:1},{default:o(()=>[t(n(w),{value:e.value.title,"onUpdate:value":a[9]||(a[9]=i=>e.value.title=i),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),t(n(u),{span:4},{default:o(()=>[t(n(N),null,{default:o(()=>[t(n(d),{type:"primary",onClick:P},{icon:o(()=>[t(s)]),default:o(()=>[a[12]||(a[12]=y(" Search ",-1))]),_:1}),t(n(d),{onClick:S},{icon:o(()=>[t(m)]),default:o(()=>[a[13]||(a[13]=y(" Reset ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(n(Y),{title:"Employee List"},{"header-extra":o(()=>[t(n(d),{type:"primary",onClick:U},{icon:o(()=>[t(T)]),default:o(()=>[a[14]||(a[14]=y(" Add Employee ",-1))]),_:1})]),default:o(()=>[t(n(Z),{columns:$,data:f.value,loading:b.value,bordered:!1,"single-line":!1,class:"user-table"},null,8,["data","loading"]),x("div",oe,[t(n(ee),{page:r.page,"onUpdate:page":a[10]||(a[10]=i=>r.page=i),"page-size":r.pageSize,"item-count":r["item-count"],"show-size-picker":!1},null,8,["page","page-size","item-count"]),x("div",ie,[a[16]||(a[16]=x("span",{class:"text-sm"},"Jump to:",-1)),t(n(v),{value:p.value,"onUpdate:value":a[11]||(a[11]=i=>p.value=i),min:1,max:M.value,"show-button":!1,size:"small",style:{width:"80px"},onKeyup:L(k,["enter"])},null,8,["value","max"]),t(n(d),{size:"small",onClick:k},{default:o(()=>[...a[15]||(a[15]=[y("Go",-1)])]),_:1})])])]),_:1})])}}}),Ce=te(re,[["__scopeId","data-v-11e0102d"]]);export{Ce as default};
