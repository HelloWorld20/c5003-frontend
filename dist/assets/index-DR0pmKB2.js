import{_ as M,N as U}from"./round-add-DLFSrtba.js";import{_ as G,a as V}from"./round-search-tzxKjPJ8.js";import{d as J,r as c,bv as K,a as L,F as j,ab as q,b as O,f as o,w as n,b_ as H,g as u,B as m,h as d,e as N,c3 as Q,i as f,be as W,o as X}from"./index-Fa26LLGJ.js";import{f as Y,d as Z}from"./departments-1qq7CMQ6.js";import{_ as ee}from"./FormItem-BZKeQ143.js";import{_ as te,a as ae}from"./Grid-B2FtaVgP.js";import{N as oe}from"./Input-CaFfWc_O.js";import{_ as P}from"./Space-DmpO1c5Z.js";import{_ as ne,a as se}from"./DataTable-rjo85Lnz.js";import{_ as le}from"./InputNumber-CPlT6_RR.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-OLpDKtti.js";import"./get-D-rsvxxO.js";import"./Follower-YbKMuAEO.js";import"./use-locale-3ZZNx-H2.js";import"./use-compitable-BSzTa9o4.js";import"./get-slot-Bk_rJcZu.js";import"./Dropdown-CxFzKVN2.js";import"./use-keyboard-DyVeZvMZ.js";import"./create-C8zW23Rr.js";import"./Tooltip-DtJC1sbC.js";import"./FocusDetector-UVToc5yR.js";import"./Select-Bmi32fUm.js";import"./Forward-Cjyugl_j.js";import"./download-C2161hUv.js";const ie={class:"user-management"},ue={class:"flex items-center gap-4 mt-4"},me={class:"flex items-center gap-2"},pe=J({__name:"index",setup(_e){const w=W(),s=c({Dept_ID:"",Dept_Name:""}),p=c([]),a=K({Page_Number:1,Row_Count:10,"item-count":0}),g=c(!1),r=c(1),D=L(()=>{const t=a["item-count"];return t===0?1:Math.ceil(t/a.Row_Count)}),x=[{title:"Dept ID",key:"dept_no"},{title:"Dept Name",key:"dept_name"},{title:"Operation",key:"actions",width:150,render:t=>f(P,{},{default:()=>[f(m,{size:"small",type:"primary",onClick:()=>C(t)},{default:()=>"Edit"}),f(U,{onPositiveClick:()=>I(t)},{trigger:()=>f(m,{size:"small",type:"error"},{default:()=>"Delete"}),default:()=>"Are you sure to delete this employee?"})]})}];function C(t){console.log("编辑用户:",t),w.push({path:"/departments/detail",query:{dept_no:t.dept_no}})}async function I(t){try{await Z(t.dept_no),_(),window.$message?.success("delete success")}catch(e){window.$message?.error(e||"fail to delete")}}function R(){console.log("搜索条件:",s),a.Page_Number=1,_()}function k(){b(),_()}function $(){console.log("新增用户"),w.push("/departments/detail")}function h(){const t=r.value;if(!t||t<1){window.$message?.warning("Please enter a valid page number"),r.value=a.Page_Number;return}const e=D.value;if(t>e){window.$message?.warning(`Page number cannot exceed ${e}`),r.value=a.Page_Number;return}a.Page_Number=t}function b(){s.value={Dept_ID:"",Dept_Name:""}}async function _(){g.value=!0;try{const t={Page_Number:a.Page_Number||1,Row_Count:a.Row_Count||10};s.value.Dept_ID&&(t.Dept_ID=s.value.Dept_ID),s.value.Dept_Name&&(t.Dept_Name=s.value.Dept_Name),console.log("Search params:",t);const e=await Y(t);if(console.log("Search response:",e),Array.isArray(e)){if(p.value=e,e.length<a.Row_Count)a["item-count"]=(a.Page_Number-1)*a.Row_Count+e.length;else{const i=Math.max(100,a.Page_Number*a.Row_Count+1);a["item-count"]=i}e.length===0&&window.$message?.info("No departments found matching the search criteria")}else if(e&&e.data&&Array.isArray(e.data))if(p.value=e.data,e.total!==void 0)a["item-count"]=e.total;else{const i=Math.max(100,a.Page_Number*a.Row_Count+1);a["item-count"]=i}else p.value=[],a["item-count"]=0,window.$message?.warning("No data found")}catch(t){console.error("Search error:",t),console.error("Error details:",{message:t?.message,response:t?.response,status:t?.response?.status,data:t?.response?.data}),window.$message?.error(t?.message||t?.response?.data?.detail||"Failed to fetch departments"),p.value=[]}finally{g.value=!1}}return j(()=>{a.Page_Number=1,b(),_()}),q(()=>a.Page_Number,t=>{r.value=t,_()}),(t,e)=>{const i=oe,v=ae,z=G,A=V,S=te,B=ee,y=H,F=M,T=ne,E=se;return X(),O("div",ie,[o(y,{title:"Search Conditions",class:"mb-4"},{default:n(()=>[o(B,{model:s.value,"label-placement":"left","label-width":"130px",class:"search-form"},{default:n(()=>[o(S,{cols:4,"x-gap":16,"y-gap":16},{default:n(()=>[o(v,{label:"Dept ID",span:1},{default:n(()=>[o(i,{value:s.value.Dept_ID,"onUpdate:value":e[0]||(e[0]=l=>s.value.Dept_ID=l),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),o(v,{label:"Dept Name",span:1},{default:n(()=>[o(i,{value:s.value.Dept_Name,"onUpdate:value":e[1]||(e[1]=l=>s.value.Dept_Name=l),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),o(v,{span:2},{default:n(()=>[o(u(P),null,{default:n(()=>[o(u(m),{type:"primary",onClick:R},{icon:n(()=>[o(z)]),default:n(()=>[e[4]||(e[4]=d(" Search ",-1))]),_:1}),o(u(m),{onClick:k},{icon:n(()=>[o(A)]),default:n(()=>[e[5]||(e[5]=d(" Reset ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(y,{title:"Department List"},{"header-extra":n(()=>[o(u(m),{type:"primary",onClick:$},{icon:n(()=>[o(F)]),default:n(()=>[e[6]||(e[6]=d(" Add Department ",-1))]),_:1})]),default:n(()=>[o(T,{columns:x,data:p.value,loading:g.value,bordered:!1,"single-line":!1,class:"user-table"},null,8,["data","loading"]),N("div",ue,[o(E,{page:a.Page_Number,"onUpdate:page":e[2]||(e[2]=l=>a.Page_Number=l),"page-size":a.Row_Count,"item-count":a["item-count"],"show-size-picker":!1},null,8,["page","page-size","item-count"]),N("div",me,[e[8]||(e[8]=N("span",{class:"text-sm"},"Jump to:",-1)),o(u(le),{value:r.value,"onUpdate:value":e[3]||(e[3]=l=>r.value=l),min:1,max:D.value,"show-button":!1,size:"small",style:{width:"80px"},onKeyup:Q(h,["enter"])},null,8,["value","max"]),o(u(m),{size:"small",onClick:h},{default:n(()=>[...e[7]||(e[7]=[d("Go",-1)])]),_:1})])])]),_:1})])}}}),Me=re(pe,[["__scopeId","data-v-6f0ca475"]]);export{Me as default};
