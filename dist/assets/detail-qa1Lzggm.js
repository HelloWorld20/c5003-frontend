import{d as Y,c9 as B,r as _,br as U,bt as C,F as R,b as T,f as l,w as n,g as a,bY as V,e as A,c as F,aY as I,B as f,h as c,c7 as h,bd as S,o as b}from"./index-CfpZo8w-.js";import{a as $,u as j,b as L}from"./employee-tTf44PtV.js";import{f as O}from"./departments-PAqYqG3U.js";import{_ as G}from"./FormItem-DunN2_bb.js";import{_ as H,a as o}from"./Grid-CVbsF19X.js";import{N as u}from"./Input-DXLRnZtr.js";import{N as v}from"./Select-BixcUewK.js";import{_ as w}from"./DatePicker-LgaTArTr.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./get-DZ7P2G-Z.js";import"./get-slot-Bk_rJcZu.js";import"./use-locale-CUGND_E1.js";import"./Follower-fAuv7w7d.js";import"./Popover-CqushPYT.js";import"./use-compitable-DA0_a1mn.js";import"./FocusDetector-DEqc9KJY.js";import"./create-C8zW23Rr.js";import"./use-keyboard-C0QpISI4.js";import"./Forward-BGnG18aJ.js";const J={class:"p-6"},K={class:"mt-8 flex justify-end space-x-4"},Q=Y({name:"EmployeeDetail",__name:"detail",setup(W){const P=U(),D=S(),i=B(),d=_(null),{emp_no:m}=P.query,t=C({emp_no:"",birth_date:null,first_name:"",last_name:"",gender:"",hire_date:null,dept_no:"",title:"",salary:"",to_date:null});async function g(){if(m)try{const s=await $(m),e=Array.isArray(s)?s?.[0]:s?.data??s;if(!e)return;t.emp_no=`${e.emp_no}`||"",t.first_name=e.first_name??"",t.last_name=e.last_name??"",t.gender=e.gender??"",t.salary=`${e.salary}`||"",t.birth_date=e.birth_date?new Date(e.birth_date).getTime():null,t.hire_date=e.hire_date?new Date(e.hire_date).getTime():null,t.dept_no=e.dept_no??`${Math.floor(Math.random()*9e5)+1e4}`,t.title=e.title??"",t.to_date=e.to_date?new Date(e.to_date).getTime():null,d.value={...t}}catch(s){console.error("加载员工详情失败:",s)}}const p=_(),M=[{label:"Male",value:"M"},{label:"Female",value:"F"}],y=_([]);async function N(){try{const s=await O({Page_Number:1,Row_Count:99}),e=Array.isArray(s)?s:s?.data??[];y.value=e.map(r=>({label:r.dept_name,value:r.dept_no}))}catch(s){console.error("加载部门列表失败:",s),i.error("加载部门列表失败")}}const k={emp_no:{required:!0,message:"Please enter employee number",trigger:"blur"},first_name:{required:!0,message:"Please enter first name",trigger:"blur"},last_name:{required:!0,message:"Please enter last name",trigger:"blur"},gender:{required:!0,message:"Please select gender",trigger:"change"},birth_date:{required:!0,type:"number",message:"Please select birth date",trigger:"change"},hire_date:{required:!0,type:"number",message:"Please select hire date",trigger:"change"},dept_no:{required:!0,message:"Please select department",trigger:"change"},title:{required:!0,message:"Please select title",trigger:"change"},salary:{required:!0,message:"Please enter salary",trigger:"blur"}},q=()=>{p.value?.validate(async s=>{if(s)i.error("Please check the form information");else{const e={dept_no:t.dept_no,first_name:t.first_name,last_name:t.last_name,gender:t.gender,salary:t.salary,title:t.title,emp_no:t.emp_no,birth_date:t.birth_date?h(t.birth_date).format("YYYY-MM-DD"):null,hire_date:t.hire_date?h(t.hire_date).format("YYYY-MM-DD"):null};e.dept_no===d.value?.dept_no&&delete e.dept_no,e.salary===d.value?.salary&&delete e.salary,e.title===d.value?.title&&delete e.title;try{m?await j(t.emp_no,e).then(()=>{i.success("Employee information updated successfully!")}):await L({...e,emp_no:Math.floor(Math.random()*9e5)+1e4}).then(()=>{i.success("Employee information added successfully!")}),g()}catch(r){console.error("提交员工信息失败:",r),i.error("提交员工信息失败")}}})},x=()=>{p.value?.restoreValidation()},E=()=>{D.push("/employees")};return R(()=>{N(),g()}),(s,e)=>(b(),T("div",J,[l(a(V),{title:"Employee Information",class:"mx-auto"},{default:n(()=>[l(a(G),{ref_key:"formRef",ref:p,model:t,rules:k,"label-placement":"left","label-width":"120px",class:"space-y-4"},{default:n(()=>[l(a(H),{cols:2,"x-gap":24,"y-gap":16},{default:n(()=>[a(m)?(b(),F(a(o),{key:0,label:"Employee Number",path:"emp_no"},{default:n(()=>[l(a(u),{value:t.emp_no,"onUpdate:value":e[0]||(e[0]=r=>t.emp_no=r),placeholder:"Please enter employee number",disabled:"",class:"w-full"},null,8,["value"])]),_:1})):I("",!0),l(a(o),{label:"First Name",path:"first_name"},{default:n(()=>[l(a(u),{value:t.first_name,"onUpdate:value":e[1]||(e[1]=r=>t.first_name=r),placeholder:"Please enter first name",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Last Name",path:"last_name"},{default:n(()=>[l(a(u),{value:t.last_name,"onUpdate:value":e[2]||(e[2]=r=>t.last_name=r),placeholder:"Please enter last name",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Gender",path:"gender"},{default:n(()=>[l(a(v),{value:t.gender,"onUpdate:value":e[3]||(e[3]=r=>t.gender=r),options:M,placeholder:"Please select gender",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Birth Date",path:"birth_date"},{default:n(()=>[l(a(w),{value:t.birth_date,"onUpdate:value":e[4]||(e[4]=r=>t.birth_date=r),type:"date",placeholder:"Please select birth date",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Hire Date",path:"hire_date"},{default:n(()=>[l(a(w),{value:t.hire_date,"onUpdate:value":e[5]||(e[5]=r=>t.hire_date=r),type:"date",placeholder:"Please select hire date",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Department",path:"department"},{default:n(()=>[l(a(v),{value:t.dept_no,"onUpdate:value":e[6]||(e[6]=r=>t.dept_no=r),options:y.value,placeholder:"Please select department",class:"w-full"},null,8,["value","options"])]),_:1}),l(a(o),{label:"Title",path:"title"},{default:n(()=>[l(a(u),{value:t.title,"onUpdate:value":e[7]||(e[7]=r=>t.title=r),placeholder:"Please enter title",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Salary",path:"salary"},{default:n(()=>[l(a(u),{value:t.salary,"onUpdate:value":e[8]||(e[8]=r=>t.salary=r),placeholder:"Please enter salary",class:"w-full"},null,8,["value"])]),_:1})]),_:1}),A("div",K,[l(a(f),{onClick:E},{default:n(()=>[...e[9]||(e[9]=[c("Cancel",-1)])]),_:1}),l(a(f),{type:"info",onClick:x},{default:n(()=>[...e[10]||(e[10]=[c("Reset",-1)])]),_:1}),l(a(f),{type:"primary",onClick:q},{default:n(()=>[...e[11]||(e[11]=[c("Save",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})]))}}),ye=z(Q,[["__scopeId","data-v-cad26530"]]);export{ye as default};
