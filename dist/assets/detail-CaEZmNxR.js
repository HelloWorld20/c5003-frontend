import{d as B,c8 as U,r as _,br as C,bt as S,F as R,b as I,f as l,w as n,g as a,bY as T,e as V,c as A,aY as F,B as f,h as c,bd as M,o as b}from"./index-CgPf9EQm.js";import{a as O,u as L,b as Y}from"./employee-CWrcexus.js";import{f as $}from"./departments-DSnVw8m6.js";import{_ as j}from"./FormItem-C-80rxJ-.js";import{_ as G,a as o}from"./Grid-Bpsg71dj.js";import{N as u}from"./Input-CW-Izv7Y.js";import{N as h}from"./Select-BKdez5Gf.js";import{_ as v}from"./DatePicker-BUiC7MvA.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./get-aZYWdo8V.js";import"./get-slot-Bk_rJcZu.js";import"./use-locale-CuzreQhd.js";import"./Follower-BA0-0DAj.js";import"./Popover-qHZnx3Kc.js";import"./use-compitable-DFJDUIHc.js";import"./FocusDetector-DEKUhLld.js";import"./create-C8zW23Rr.js";import"./use-keyboard-BIDzhMOw.js";import"./Forward-DZ273ImB.js";const z={class:"p-6"},J={class:"mt-8 flex justify-end space-x-4"},K=B({name:"EmployeeDetail",__name:"detail",setup(Q){const w=C(),P=M(),i=U(),d=_(null),{emp_no:p}=w.query,t=S({emp_no:"",birth_date:null,first_name:"",last_name:"",gender:"",hire_date:null,dept_no:"",title:"",salary:""});async function g(){if(p)try{const s=await O(p),e=Array.isArray(s)?s?.[0]:s?.data??s;if(!e)return;t.emp_no=`${e.emp_no}`||"",t.first_name=e.first_name??"",t.last_name=e.last_name??"",t.gender=e.gender??"",t.salary=`${e.salary}`||"",t.birth_date=e.birth_date?new Date(e.birth_date).getTime():null,t.hire_date=e.hire_date?new Date(e.hire_date).getTime():null,t.dept_no=e.dept_no??"",t.title=e.title??"",d.value={...t}}catch(s){console.error("加载员工详情失败:",s)}}const m=_(),D=[{label:"Male",value:"M"},{label:"Female",value:"F"}],y=_([]);async function N(){try{const s=await $({Page_Number:1,Row_Count:99}),e=Array.isArray(s)?s:s?.data??[];y.value=e.map(r=>({label:r.dept_name,value:r.dept_no}))}catch(s){console.error("加载部门列表失败:",s),i.error("加载部门列表失败")}}const k={emp_no:{required:!0,message:"Please enter employee number",trigger:"blur"},first_name:{required:!0,message:"Please enter first name",trigger:"blur"},last_name:{required:!0,message:"Please enter last name",trigger:"blur"},gender:{required:!0,message:"Please select gender",trigger:"change"},birth_date:{required:!0,type:"number",message:"Please select birth date",trigger:"change"},hire_date:{required:!0,type:"number",message:"Please select hire date",trigger:"change"},dept_no:{required:!0,message:"Please select department",trigger:"change"},title:{required:!0,message:"Please select title",trigger:"change"},salary:{required:!0,message:"Please enter salary",trigger:"blur"}},q=()=>{m.value?.validate(async s=>{if(s)i.error("Please check the form information");else{const e={dept_no:t.dept_no,first_name:t.first_name,last_name:t.last_name,gender:t.gender,salary:t.salary,title:t.title,emp_no:t.emp_no,birth_date:t.birth_date?new Date(t.birth_date).toISOString().split("T")[0]:null,hire_date:t.hire_date?new Date(t.hire_date).toISOString().split("T")[0]:null};e.dept_no===d.value.dept_no&&delete e.dept_no,e.salary===d.value.salary&&delete e.salary,e.title===d.value.title&&delete e.title;try{p?await L(t.emp_no,e).then(()=>{i.success("Employee information updated successfully!")}):await Y({...e}).then(()=>{i.success("Employee information added successfully!")}),g()}catch(r){console.error("提交员工信息失败:",r),i.error("提交员工信息失败")}}})},x=()=>{m.value?.restoreValidation()},E=()=>{P.push("/employees")};return R(()=>{N(),g()}),(s,e)=>(b(),I("div",z,[l(a(T),{title:"Employee Information",class:"mx-auto"},{default:n(()=>[l(a(j),{ref_key:"formRef",ref:m,model:t,rules:k,"label-placement":"left","label-width":"120px",class:"space-y-4"},{default:n(()=>[l(a(G),{cols:2,"x-gap":24,"y-gap":16},{default:n(()=>[a(p)?(b(),A(a(o),{key:0,label:"Employee Number",path:"emp_no"},{default:n(()=>[l(a(u),{value:t.emp_no,"onUpdate:value":e[0]||(e[0]=r=>t.emp_no=r),placeholder:"Please enter employee number",disabled:"",class:"w-full"},null,8,["value"])]),_:1})):F("",!0),l(a(o),{label:"First Name",path:"first_name"},{default:n(()=>[l(a(u),{value:t.first_name,"onUpdate:value":e[1]||(e[1]=r=>t.first_name=r),placeholder:"Please enter first name",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Last Name",path:"last_name"},{default:n(()=>[l(a(u),{value:t.last_name,"onUpdate:value":e[2]||(e[2]=r=>t.last_name=r),placeholder:"Please enter last name",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Gender",path:"gender"},{default:n(()=>[l(a(h),{value:t.gender,"onUpdate:value":e[3]||(e[3]=r=>t.gender=r),options:D,placeholder:"Please select gender",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Birth Date",path:"birth_date"},{default:n(()=>[l(a(v),{value:t.birth_date,"onUpdate:value":e[4]||(e[4]=r=>t.birth_date=r),type:"date",placeholder:"Please select birth date",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Hire Date",path:"hire_date"},{default:n(()=>[l(a(v),{value:t.hire_date,"onUpdate:value":e[5]||(e[5]=r=>t.hire_date=r),type:"date",placeholder:"Please select hire date",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Department",path:"department"},{default:n(()=>[l(a(h),{value:t.dept_no,"onUpdate:value":e[6]||(e[6]=r=>t.dept_no=r),options:y.value,placeholder:"Please select department",class:"w-full"},null,8,["value","options"])]),_:1}),l(a(o),{label:"Title",path:"title"},{default:n(()=>[l(a(u),{value:t.title,"onUpdate:value":e[7]||(e[7]=r=>t.title=r),placeholder:"Please enter title",class:"w-full"},null,8,["value"])]),_:1}),l(a(o),{label:"Salary",path:"salary"},{default:n(()=>[l(a(u),{value:t.salary,"onUpdate:value":e[8]||(e[8]=r=>t.salary=r),placeholder:"Please enter salary",class:"w-full"},null,8,["value"])]),_:1})]),_:1}),V("div",J,[l(a(f),{onClick:E},{default:n(()=>[...e[9]||(e[9]=[c("Cancel",-1)])]),_:1}),l(a(f),{type:"info",onClick:x},{default:n(()=>[...e[10]||(e[10]=[c("Reset",-1)])]),_:1}),l(a(f),{type:"primary",onClick:q},{default:n(()=>[...e[11]||(e[11]=[c("Save",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})]))}}),ge=H(K,[["__scopeId","data-v-5435b2e8"]]);export{ge as default};
