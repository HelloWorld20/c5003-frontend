import{_ as P,a as k}from"./round-search-tzxKjPJ8.js";import{d as Y,r as y,bv as T,a as U,F as C,ab as $,b as R,f as l,w as u,g as t,c7 as c,B as E,h as b,b_ as I,e as x,c3 as A,o as F}from"./index-Fa26LLGJ.js";import{c as j}from"./employee-B_1zAmv9.js";import{_ as z}from"./FormItem-BZKeQ143.js";import{_ as B,a as i}from"./Grid-B2FtaVgP.js";import{N as p}from"./Input-CaFfWc_O.js";import{_ as v}from"./InputNumber-CPlT6_RR.js";import{_ as D}from"./DatePicker-rMn-1Kn0.js";import{_ as H}from"./Space-DmpO1c5Z.js";import{_ as V,a as J}from"./DataTable-rjo85Lnz.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./get-D-rsvxxO.js";import"./get-slot-Bk_rJcZu.js";import"./use-locale-3ZZNx-H2.js";import"./use-keyboard-DyVeZvMZ.js";import"./FocusDetector-UVToc5yR.js";import"./Follower-YbKMuAEO.js";import"./Forward-Cjyugl_j.js";import"./Dropdown-CxFzKVN2.js";import"./Popover-OLpDKtti.js";import"./use-compitable-BSzTa9o4.js";import"./create-C8zW23Rr.js";import"./Tooltip-DtJC1sbC.js";import"./Select-Bmi32fUm.js";import"./download-C2161hUv.js";const G={class:"employee-history"},O={class:"flex items-center gap-4 mt-4"},q={class:"flex items-center gap-2"},L=Y({name:"EmployeeHistory",__name:"history",setup(Q){const e=y({Employee_ID_min:null,Employee_ID_max:null,Employee_Name:"",Manager_Name:"",Title:"",Salary_min:null,Salary_max:null,Department_Number:"",Department:"",Effective_Date_min:null,Effective_Date_max:null,End_Date_min:null,End_Date_max:null}),d=y([]),m=T({Page_Number:1,Row_Count:10,"item-count":0}),g=y(!1),s=y(1),N=U(()=>{const n=m["item-count"];return n===0?1:Math.ceil(n/m.Row_Count)}),S=[{title:"Employee ID",key:"emp_no",width:100},{title:"Employee Name",key:"employee_name",width:180,render:n=>`${n.employee_first_name||""} ${n.employee_last_name||""}`.trim()},{title:"Title",key:"title",width:180},{title:"Salary",key:"salary",width:120,render:n=>`$ ${n.salary||0}`},{title:"Dept ID",key:"dept_no",width:100},{title:"Dept Name",key:"dept_name",width:180},{title:"Manager Name",key:"manager_name",width:180,render:n=>`${n.manager_first_name||""} ${n.manager_last_name||""}`.trim()},{title:"Effective Date",key:"effective_date",width:140},{title:"End Date",key:"end_date",width:140}];async function f(){g.value=!0;try{const n={Page_Number:m.Page_Number||1,Row_Count:m.Row_Count||10};if(e.value.Employee_ID_min!==null&&e.value.Employee_ID_min!==""){const r=parseInt(e.value.Employee_ID_min.toString());isNaN(r)||(n.Employee_ID_min=r)}if(e.value.Employee_ID_max!==null&&e.value.Employee_ID_max!==""){const r=parseInt(e.value.Employee_ID_max.toString());isNaN(r)||(n.Employee_ID_max=r)}if(e.value.Salary_min!==null&&e.value.Salary_min!==""){const r=parseInt(e.value.Salary_min.toString());isNaN(r)||(n.Salary_min=r)}if(e.value.Salary_max!==null&&e.value.Salary_max!==""){const r=parseInt(e.value.Salary_max.toString());isNaN(r)||(n.Salary_max=r)}e.value.Effective_Date_min&&(n.Effective_Date_min=c(e.value.Effective_Date_min).format("YYYY-MM-DD")),e.value.Effective_Date_max&&(n.Effective_Date_max=c(e.value.Effective_Date_max).format("YYYY-MM-DD")),e.value.End_Date_min&&(n.End_Date_min=c(e.value.End_Date_min).format("YYYY-MM-DD")),e.value.End_Date_max&&(n.End_Date_max=c(e.value.End_Date_max).format("YYYY-MM-DD")),e.value.Employee_Name&&(n.Employee_Name=e.value.Employee_Name),e.value.Manager_Name&&(n.Manager_Name=e.value.Manager_Name),e.value.Title&&(n.Title=e.value.Title),e.value.Department_Number&&(n.Department_Number=e.value.Department_Number),e.value.Department&&(n.Department=e.value.Department),console.log("Search params:",n);const a=await j(n);console.log("Employee history response:",a),console.log("Response type:",typeof a),console.log("Is array:",Array.isArray(a));let _=[];if(Array.isArray(a)?_=a:a&&Array.isArray(a.data)?_=a.data:a&&a.data?_=Array.isArray(a.data)?a.data:[]:a&&typeof a=="object"&&(console.log("Response is object, keys:",Object.keys(a)),(a.emp_no||a.employee_first_name)&&(_=[a])),console.log("Extracted data:",_),console.log("Data length:",_.length),_&&_.length>0)if(d.value=_,_.length<m.Row_Count)m["item-count"]=(m.Page_Number-1)*m.Row_Count+_.length;else{const r=Math.max(100,m.Page_Number*m.Row_Count+1);m["item-count"]=r}else d.value=[],m["item-count"]=0,(e.value.Employee_ID_min||e.value.Employee_ID_max||e.value.Employee_Name||e.value.Manager_Name||e.value.Title||e.value.Salary_min||e.value.Salary_max||e.value.Department_Number||e.value.Department||e.value.Effective_Date_min||e.value.Effective_Date_max||e.value.End_Date_min||e.value.End_Date_max)&&window.$message?.warning("No data found")}catch(n){console.error("Search error:",n),window.$message?.error(n?.message||"Failed to fetch employee history"),d.value=[]}finally{g.value=!1}}function M(){console.log("Search conditions:",e),m.Page_Number=1,f()}function w(){e.value={Employee_ID_min:null,Employee_ID_max:null,Employee_Name:"",Manager_Name:"",Title:"",Salary_min:null,Salary_max:null,Department_Number:"",Department:"",Effective_Date_min:null,Effective_Date_max:null,End_Date_min:null,End_Date_max:null},m.Page_Number=1,f()}function h(){const n=s.value;if(!n||n<1){window.$message?.warning("Please enter a valid page number"),s.value=m.Page_Number;return}const a=N.value;if(n>a){window.$message?.warning(`Page number cannot exceed ${a}`),s.value=m.Page_Number;return}m.Page_Number=n}return C(()=>{w(),f()}),$(()=>m.Page_Number,n=>{s.value=n,f()}),(n,a)=>{const _=P,r=k;return F(),R("div",G,[l(t(I),{title:"Search Conditions",class:"mb-4"},{default:u(()=>[l(t(z),{model:e.value,"label-placement":"left","label-width":"150px",class:"search-form"},{default:u(()=>[l(t(B),{cols:4,"x-gap":16,"y-gap":16},{default:u(()=>[l(t(i),{label:"Employee Name",span:1},{default:u(()=>[l(t(p),{value:e.value.Employee_Name,"onUpdate:value":a[0]||(a[0]=o=>e.value.Employee_Name=o),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),l(t(i),{label:"Employee ID Min",span:1},{default:u(()=>[l(t(v),{value:e.value.Employee_ID_min,"onUpdate:value":a[1]||(a[1]=o=>e.value.Employee_ID_min=o),clearable:"",placeholder:"Min","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"Employee ID Max",span:1},{default:u(()=>[l(t(v),{value:e.value.Employee_ID_max,"onUpdate:value":a[2]||(a[2]=o=>e.value.Employee_ID_max=o),clearable:"",placeholder:"Max","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"Manager Name",span:1},{default:u(()=>[l(t(p),{value:e.value.Manager_Name,"onUpdate:value":a[3]||(a[3]=o=>e.value.Manager_Name=o),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),l(t(i),{label:"Title",span:1},{default:u(()=>[l(t(p),{value:e.value.Title,"onUpdate:value":a[4]||(a[4]=o=>e.value.Title=o),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),l(t(i),{label:"Salary Min",span:1},{default:u(()=>[l(t(v),{value:e.value.Salary_min,"onUpdate:value":a[5]||(a[5]=o=>e.value.Salary_min=o),clearable:"",placeholder:"Min","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"Salary Max",span:1},{default:u(()=>[l(t(v),{value:e.value.Salary_max,"onUpdate:value":a[6]||(a[6]=o=>e.value.Salary_max=o),clearable:"",placeholder:"Max","show-button":!1,style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"Dept ID",span:1},{default:u(()=>[l(t(p),{value:e.value.Department_Number,"onUpdate:value":a[7]||(a[7]=o=>e.value.Department_Number=o),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),l(t(i),{label:"Dept Name",span:1},{default:u(()=>[l(t(p),{value:e.value.Department,"onUpdate:value":a[8]||(a[8]=o=>e.value.Department=o),clearable:"",placeholder:"Please Input"},null,8,["value"])]),_:1}),l(t(i),{label:"Effective Date From",span:1},{default:u(()=>[l(t(D),{value:e.value.Effective_Date_min,"onUpdate:value":a[9]||(a[9]=o=>e.value.Effective_Date_min=o),type:"date",clearable:"",placeholder:"Select Date",style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"Effective Date To",span:1},{default:u(()=>[l(t(D),{value:e.value.Effective_Date_max,"onUpdate:value":a[10]||(a[10]=o=>e.value.Effective_Date_max=o),type:"date",clearable:"",placeholder:"Select Date",style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"End Date From",span:1},{default:u(()=>[l(t(D),{value:e.value.End_Date_min,"onUpdate:value":a[11]||(a[11]=o=>e.value.End_Date_min=o),type:"date",clearable:"",placeholder:"Select Date",style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{label:"End Date To",span:1},{default:u(()=>[l(t(D),{value:e.value.End_Date_max,"onUpdate:value":a[12]||(a[12]=o=>e.value.End_Date_max=o),type:"date",clearable:"",placeholder:"Select Date",style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(i),{span:4},{default:u(()=>[l(t(H),null,{default:u(()=>[l(t(E),{type:"primary",onClick:M},{icon:u(()=>[l(_)]),default:u(()=>[a[15]||(a[15]=b(" Search ",-1))]),_:1}),l(t(E),{onClick:w},{icon:u(()=>[l(r)]),default:u(()=>[a[16]||(a[16]=b(" Reset ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(I),{title:"Employee History"},{default:u(()=>[l(t(V),{columns:S,data:d.value,loading:g.value,bordered:!1,"single-line":!1,class:"history-table"},null,8,["data","loading"]),x("div",O,[l(t(J),{page:m.Page_Number,"onUpdate:page":a[13]||(a[13]=o=>m.Page_Number=o),"page-size":m.Row_Count,"item-count":m["item-count"],"show-size-picker":!1},null,8,["page","page-size","item-count"]),x("div",q,[a[18]||(a[18]=x("span",{class:"text-sm"},"Jump to:",-1)),l(t(v),{value:s.value,"onUpdate:value":a[14]||(a[14]=o=>s.value=o),min:1,max:N.value,"show-button":!1,size:"small",style:{width:"80px"},onKeyup:A(h,["enter"])},null,8,["value","max"]),l(t(E),{size:"small",onClick:h},{default:u(()=>[...a[17]||(a[17]=[b("Go",-1)])]),_:1})])])]),_:1})])}}}),xe=K(L,[["__scopeId","data-v-715c1b99"]]);export{xe as default};
